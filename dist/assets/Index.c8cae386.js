var J=Object.defineProperty;var K=(s,e,t)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var x=(s,e,t)=>(K(s,typeof e!="symbol"?e+"":e,t),t),D=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var a=(s,e,t)=>(D(s,e,"read from private field"),t?t.call(s):e.get(s)),$=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},_=(s,e,t,u)=>(D(s,e,"write to private field"),u?u.call(s,t):e.set(s,t),t);import{d as b,e as h,f as S,s as o,G as T,g as V,r as L,o as E,h as Q,w as C,i as v,t as O,u as y,a as M,B as Z,b as tt,_ as U,j as Y,c as R,k as N,v as F,F as A,p as z,l as W,m as et,T as st,n as at}from"./index.524b5c74.js";var k;class ut{constructor(e,t,u){$(this,k,void 0);x(this,"x");x(this,"y");_(this,k,b(e)),this.x=t,this.y=u}set tag(e){a(this,k).value=e}get tag(){return a(this,k).value}}k=new WeakMap;class nt{constructor(e,t,u){x(this,"value");x(this,"x");x(this,"y");this.value=e,this.x=t,this.y=u}}const G="game/";let j;const X=h({get(){return o.state.game.sec},set(s){return o.dispatch(G+T.SEC,s)}}),P=h({get(){return o.state.game.pause},set(s){return o.dispatch(G+T.PAUSE,s)}}),H=h({get(){return o.state.game.countMove},set(s){return o.dispatch(G+T.COUNT_MOVE,s)}}),w=h({get(){return o.state.game.triggerGame},set(s){return o.dispatch(G+T.TRIGGER_GAME,s)}});S(()=>P.value,s=>{s?clearInterval(j):j=setInterval(()=>{X.value++},1e3)});S(()=>w.value,s=>{P.value=!s});class ot{defaultVariables(){P.value=!1,w.value=!0,H.value=0,X.value=0}basicMoveLogic(e){!this.moveCheck(e)||P.value||!w.value||(this.move(e),H.value++,w.value=!this.gameEndCheck)}}const B=h(()=>o.state.settings.tagsColumns.value),q=h(()=>o.state.settings.tagsRows.value);var g,d,i;class it extends ot{constructor(){super();$(this,g,void 0);$(this,d,void 0);$(this,i,void 0);_(this,g,rt()),_(this,i,a(this,g)[a(this,g).length-1]),_(this,d,a(this,i).tag),this.defaultVariables(),this.shuffleCells()}get cells(){return a(this,g)}get tagOpacity(){return a(this,d)}set tagOpacity(t){_(this,d,t)}get cellOpacity(){return a(this,i)}set cellOpacity(t){_(this,i,t)}get cellsByColumn(){return a(this,g).reduce((t,u)=>(t[u.x]=t[u.x]||[],t[u.x][u.y]=u,t),[])}get cellsByRow(){return a(this,g).reduce((t,u)=>(t[u.y]=t[u.y]||[],t[u.y][u.x]=u,t),[])}get gameEndCheck(){return a(this,g).every((t,u)=>t.tag.value===u)}opacityCellAndTag(){_(this,i,a(this,g)[a(this,g).length-1]),_(this,d,this.cellOpacity.tag)}shuffleCells(){function t(n){for(let l=n.length-1;l>0;l--){let I=Math.floor(Math.random()*(l+1));[n[l],n[I]]=[n[I],n[l]]}return n}function u(){return c.every((n,l)=>n===l)}let c=[...Array(a(this,g).length).keys()];c=t(c);let p=0,r=c.findIndex(n=>a(this,d).value===n);B.value%2===0&&(q.value-Math.floor(r/B.value))%2===0&&p++;const m=c.filter(n=>a(this,d).value!==n);for(let n=0;n<m.length;n++)for(let l=n+1;l<m.length;l++)m[n]>m[l]&&p++;if(p%2!==0||u())return this.shuffleCells();let f=[];c.forEach((n,l)=>{f.push(a(this,g)[l].tag),a(this,g)[l].tag=f[n]||a(this,g)[n].tag,a(this,g)[l].tag.value===a(this,d).value&&_(this,i,a(this,g)[l])})}arrayShiftToRight(t){_(this,i,t[0]);let u=t[t.length-1].tag;for(let c=t.length-1;c>0;c--)t[c].tag=t[c-1].tag;t[0].tag=u}move(t){a(this,i).y>t.y&&this.arrayShiftToRight(this.cellsByColumn[t.x].slice(t.y,a(this,i).y+1)),a(this,i).y<t.y&&this.arrayShiftToRight(this.cellsByColumn[t.x].slice(a(this,i).y,t.y+1).reverse()),a(this,i).x>t.x&&this.arrayShiftToRight(this.cellsByRow[t.y].slice(t.x,a(this,i).x+1)),a(this,i).x<t.x&&this.arrayShiftToRight(this.cellsByRow[t.y].slice(a(this,i).x,t.x+1).reverse())}moveCheck(t){return a(this,i).x!==t.x&&a(this,i).y===t.y||a(this,i).x===t.x&&a(this,i).y!==t.y}}g=new WeakMap,d=new WeakMap,i=new WeakMap;function rt(){const s=[];for(let e=0;e<B.value*q.value;e++){const t=e%B.value,u=Math.floor(e/B.value);s.push(new ut(new nt(e,t,u),t,u))}return s}const lt=v("h3",null,"\u0412\u044B \u0432\u044B\u0438\u0433\u0440\u0430\u043B\u0438!",-1),ct=tt("\u041D\u0430\u0437\u0430\u0434"),gt=["onClick"],ht=V({__name:"GameModal",setup(s){const e="game/",t=h(()=>o.state.game.countMove),u=h(()=>o.getters[e+"getTime"]),c=h({get(){return o.state.game.triggerGame},set(p){return o.dispatch(e+T.TRIGGER_GAME,p)}});return(p,r)=>{const m=L("router-link");return E(),Q(Z,{isOpen:!y(c),onClose:r[0]||(r[0]=f=>c.value=!0)},{header:C(()=>[lt]),body:C(()=>[v("p",null,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0445\u043E\u0434\u043E\u0432: "+O(y(t)),1),v("p",null,"\u0412\u0440\u0435\u043C\u044F: "+O(y(u)),1)]),footer:C(({close:f})=>[M(m,{class:"button back",to:{name:"Main"}},{default:C(()=>[ct]),_:1}),v("button",{onClick:f},"\u041D\u0430\u0447\u0430\u0442\u044C \u0441 \u043D\u0430\u0447\u0430\u043B\u0430",8,gt)]),_:1},8,["isOpen"])}}});const vt=s=>(z("data-v-096a9521"),s=s(),W(),s),mt=["src"],pt={class:"icon-Play"},yt={class:"icon-Pause"},_t=vt(()=>v("span",{class:"icon-Menu"},null,-1)),dt=V({__name:"GameHeader",setup(s){const e="game/",t=h(()=>o.state.game.countMove);h(()=>o.state.game.sec);const u=h(()=>o.getters[e+"getTime"]),c=h(()=>o.state.game.audioSrc),p=h({get(){return o.state.game.pause},set(f){return o.dispatch(e+T.PAUSE,f)}}),r=o.state.settings.gameVolume,m=b();return Y(()=>{m.value.volume=1/r.max*r.value,S(()=>t.value,()=>{m.value.pause(),m.value.currentTime=0,m.value.play()})}),(f,n)=>{const l=L("router-link");return E(),R(A,null,[v("audio",{ref_key:"audio",ref:m,src:y(c)},null,8,mt),v("header",null,[v("nav",null,[v("p",null,"\u0412\u0440\u0435\u043C\u044F: "+O(y(u)),1),v("div",{onClick:n[0]||(n[0]=I=>p.value=!y(p))},[N(v("span",pt,null,512),[[F,y(p)]]),N(v("span",yt,null,512),[[F,!y(p)]])]),v("p",null,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0445\u043E\u0434\u043E\u0432: "+O(y(t)),1),M(l,{to:{name:"Main"}},{default:C(()=>[_t]),_:1})])])],64)}}});var ft=U(dt,[["__scopeId","data-v-096a9521"]]);const xt=s=>(z("data-v-3d0ef8d0"),s=s(),W(),s),Ct=xt(()=>v("aside",null,null,-1)),kt={id:"game-board"},Tt=["onClick"],$t=V({__name:"Index",setup(s){const e=new it,t=h(()=>o.state.game.triggerGame),u=h(()=>o.state.settings.tagsColumns.value),c=h(()=>o.state.settings.tagsRows.value),p=h(()=>o.state.settings.imgs.value),r=b();return Y(()=>{r.value.style.setProperty("--tags-columns",`${u.value}`),r.value.style.setProperty("--tags-rows",`${c.value}`),r.value.style.setProperty("--aside-x",`${e.tagOpacity.x+1}`),r.value.style.setProperty("--aside-y",`${e.tagOpacity.y+1}`),r.value.style.setProperty("--background-image",`url(${p.value})`),r.value.style.setProperty("--no-full-image-opacity","1"),S(()=>t.value,m=>{m?(e.defaultVariables(),r.value.style.setProperty("--aside-x",`${e.tagOpacity.x+1}`),r.value.style.setProperty("--aside-y",`${e.tagOpacity.y+1}`),r.value.style.setProperty("--no-full-image-opacity","1"),e.shuffleCells()):r.value.style.setProperty("--no-full-image-opacity","0")})}),(m,f)=>(E(),R(A,null,[v("div",{ref_key:"game",ref:r,class:"game"},[M(ft),Ct,v("main",null,[v("div",kt,[M(st,{name:"moving"},{default:C(()=>[(E(!0),R(A,null,et(y(e).cells,n=>(E(),R("div",{onClick:l=>y(e).basicMoveLogic(n),key:n.tag.value,style:at(`
              --x: ${n.tag.x};
              --y: ${n.tag.y};
              --opacity: ${n.tag.value===y(e).tagOpacity.value?0:1}
            `),class:"tag"},null,12,Tt))),128))]),_:1})])])],512),M(ht)],64))}});var Bt=U($t,[["__scopeId","data-v-3d0ef8d0"]]);export{Bt as default};
